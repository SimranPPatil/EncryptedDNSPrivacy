create table if not exists sites (
	id  INTEGER PRIMARY KEY,
	url  TEXT UNIQUE,
	domain  TEXT UNIQUE,
	scheme  TEXT,
	begin_crawl INTEGER);

create index if not exists sites_id on sites(id);

create table if not exists crawl_data (
	load_id INTEGER PRIMARY KEY,
	scan_id INTEGER,
	load_domain STRING,
	scheme STRING,
	port INTEGER,
	load_url STRING,
	load_type STRING,
	UNIQUE(load_id, scan_id));

create index if not exists crawl_id on crawl_data(load_id);
create index if not exists crawl_scan on crawl_data(scan_id);
create index if not exists crawl_domain on crawl_data(load_domain);

create table if not exists response_headers (
	load_id INTEGER,
	header TEXT,
	value TEXT);

create index if not exists response_headers_id on response_headers(load_id);

create table if not exists cert_sans (
	domain TEXT,
	san TEXT,
	UNIQUE(domain,san)
);

create index if not exists san_domain on cert_sans(domain);

create table if not exists domain2ip (
    domain TEXT,
    ip INTEGER,
    UNIQUE(domain,ip)
);

create index if not exists domain2ip_domain on domain2ip(domain);
create index if not exists domain2ip_ip on domain2ip(ip);

create table if not exists cnames (
  domain TEXT,
  cname TEXT);

create index if not exists cnames_domain on cnames(domain);

create table if not exists rdns (
    ip INTEGER,
    domain TEXT,
    UNIQUE(ip,domain)
);

create index if not exists rdns_ip on rdns(ip);

create table if not exists ip_cdn (
  ip INTEGER,
  cdn TEXT);

create index if not exists ip_cdn_ip on ip_cdn(ip);

create table if not exists load_cdn (
	load_id INTEGER PRIMARY KEY,
	scan_id INTEGER,
	load_url STRING,
	cdn STRING,
	UNIQUE(load_id, scan_id));

create index if not exists load_cdn_id on load_cdn(load_id);