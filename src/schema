create table if not exists sites (
	id  INTEGER PRIMARY KEY,
	url  TEXT UNIQUE,
	domain  TEXT UNIQUE,
	scheme  TEXT,
	begin_crawl INTEGER);

create index if not exists sites_id on sites(id);

create table if not exists bq_crawl (
	id  INTEGER PRIMARY KEY,
	site  TEXT,
	domain  TEXT,
	url TEXT,
	scheme  TEXT,
	port INTEGER,
	begin_crawl INTEGER,
	mimeType TEXT,
	cdn TEXT,
	type TEXT,
	format TEXT,
	resp_server TEXT);

create index if not exists bq_id on bq_crawl(id);

create table if not exists crawl_data (
	load_id INTEGER PRIMARY KEY,
	scan_id INTEGER,
	load_domain STRING,
	scheme STRING,
	port INTEGER,
	load_url STRING,
	load_type STRING);

create index if not exists crawl_id on crawl_data(load_id);
create index if not exists crawl_scan on crawl_data(scan_id);
create index if not exists crawl_domain on crawl_data(load_domain);

create table if not exists response_headers (
	load_id INTEGER,
	header TEXT,
	value TEXT);

create index if not exists response_headers_id on response_headers(load_id);

create table if not exists cert_sans (
	domain TEXT,
	san TEXT,
	UNIQUE(domain,san)
);

create index if not exists san_domain on cert_sans(domain);

create table if not exists domain2ip (
    domain TEXT,
    ip INTEGER,
    UNIQUE(domain,ip)
);

create index if not exists domain2ip_domain on domain2ip(domain);
create index if not exists domain2ip_ip on domain2ip(ip);

create table if not exists cnames (
  domain TEXT,
  cname TEXT);

create index if not exists cnames_domain on cnames(domain);

create table if not exists cnames_cdn (
  domain TEXT,
  cname TEXT,
  cdn TEXT);

create index if not exists cnames_cdn_domain on cnames_cdn(domain);
